{% extends "index.html" %}
{% load humanize %}
{% load static %}

{% block underoverskrift %}
	Driftsmodeller
	{% if user.is_authenticated %}
	<div>
		<a class="btn btn-sm btn-primary" target="_blank" href="/admin/systemoversikt/driftsmodell/add/">Legg til ny driftsmodell</a>
	</div>
	{% endif %}
{% endblock underoverskrift %}

{% block main_content %}
<p>Oversikt over driftsmodeller / driftsplattformer. Systemer angis med en av disse driftsmodellene. En driftsmodell er ogs√• forvaltet av en virksomhet. Viser alle {{ driftsmodeller.count }}.</p>

<table id="stickyheader" class="table table-sm table-striped tablesorter">
	<thead>
	<tr>
		{% if user.is_authenticated %}
		<th>Rediger</th>
		{% endif %}
		<th>Driftsmodeller</th>
		<th>Forvaltet av</th>
		{% if user.is_authenticated %}
		<th>Slett</th>
		{% endif %}
	</tr>
	</thead>
	<tbody>
	{% for item in driftsmodeller %}
	<tr {% if item.own_domain %} style="background-color: #fffee6;" {% endif %}>

		{% if user.is_authenticated %}
		<td>
			<a target="_blank" href="/admin/systemoversikt/driftsmodell/{{ item.pk }}/change/"><img style="width: 11px; margin: 3px;" src="{% static 'open-iconic/svg/pencil.svg' %}" alt="rediger"></a>
		</td>
		{% endif %}
		<td>
			{% url 'detaljer_driftsmodell' pk=item.pk as url_detaljer_driftsmodell %}
				<a href="{{ url_detaljer_driftsmodell }}">{{ item }}</a>
		</td>
		<td>
			{% url 'virksomhet' pk=item.ansvarlig_virksomhet.pk as url_detaljer_virksomhet %}
				<a href="{{ url_detaljer_virksomhet }}">{{ item.ansvarlig_virksomhet|default:"-" }}</a>
		</td>
		{% if user.is_authenticated %}
		<td>
			<a target="_blank" href="/admin/systemoversikt/driftsmodell/{{ item.pk }}/delete/"><img style="width: 8px; margin: 3px;" src="{% static 'open-iconic/svg/x.svg' %}" alt="slett"></a>
		</td>
		{% endif %}

	</tr>
	{% endfor %}
	</tbody>
</table>
{% endblock main_content %}