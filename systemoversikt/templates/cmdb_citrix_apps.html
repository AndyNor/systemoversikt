{% extends "cmdb_index.html" %}
{% load humanize %}
{% load static %}

{% block ekstrameny_business_service %}
{% endblock ekstrameny_business_service %}

{% block overskrift %}
	Citrix-publiseringer
{% endblock overskrift %}

{% block hovedinnhold %}

	{% if not filter %}

		<p>Det er {{antall_apper_totalt}} citrixapper. {{citrixapps|length}} er aktive og vises her. Av disse mangler {{antall_apper_koblet}} ({{antall_apper_koblet_pct}}) kobling til et system. Se ogs친 <a href="{% url 'systemer_citrix' %}">oversikt over systemer koblet til citrix</a>.</p>

		<p style="background-color: {{ integrasjonsstatus.color }};">
			Citrix-apper ble sist synkronisert {{ integrasjonsstatus.dato_sist_oppdatert|date:"d.M Y"|default:"ukjent" }}</p>

		Unike siloer:
		<ul style="column-count:5;">
		{% for silo in unike_siloer %}
			{% if silo.citrix_desktop_group != None %}
			<li><a href="{% url 'citrix_desktop_group' %}?gruppe={{silo.citrix_desktop_group}}">{{silo.citrix_desktop_group}}</a></li>
			{% endif %}
		{% endfor %}
		</ul>

	{% endif %}

<table class="table table-sm tablesorter excel">
<thead>
	<td>Opprettet</td>
	<th>Sone</th>
	<th>Terminalservergruppe<br>(DesktopGroup)</th>
	<th>Mappe<br>(ClientFolder og AdminFolderName)</th>
	<th>Applikasjonsnavn<br>(Application Name og BrowserName)</th>
	<th>Systemkoblet?</th>
	<th>Ansvarlige</th>
	<th>Totalt antall unike medlemmer</th>
	<th>Hva som kj칮res<br>(WorkingDirectory, CommandLineExecutable og CommandLineArguments)</th>
	<th>Produksjon</th>
	<th>NHN-nettside</th>
	<th>vApp</th>
	<th>Nettleser</th>
	<th>Remote desktop</th>
	<th>EXE</th>
	<th>BAT</th>
	<th>VBS</th>
	<th>PS1</th>
	<th>CMD</th>
	<th>Har medlemmer</th>
	<th>Description</th>
	<th>UserFilterEnabled</th>

</thead>
<tbody>
	{% for app in citrixapps %}
	<tr>
		<td>{{app.opprettet|date:"Y-m-d H:i"}}</td>
		<td>{{app.sone}}</td>

		<td style="white-space: nowrap;">
			{% for name in app.publikasjon_json.AllAssociatedDesktopGroupUids_Name %}
			<a href="{% url 'citrix_desktop_group' %}?gruppe={{name}}">{{name}}</a><br>
			{% endfor %}
		</td>

		<td>
			{{app.publikasjon_json.ClientFolder|default:""}}
			<span style="color: grey;">{{app.publikasjon_json.AdminFolderName}}</span><br>
		</td>

		<td>
			<b>{{app.publikasjon_json.ApplicationName|default:"-"}}</b>
			<span style="color: grey;">{{app.publikasjon_json.BrowserName|default:"-"}}</span><br>
		</td>

		<td>
			{% for system in app.systemer.all %}
				{{ system.systemnavn }}<br>{{ system.get_livslop_status_display }}<br>
			{% empty %}
				-
			{% endfor %}
		</td>

		<td>
			<b>Virksomhet:</b><br>
			{% for system in app.systemer.all %}
				{{ system.systemforvalter.virksomhetsforkortelse }}<br>
			{% empty %}
				-<br>
			{% endfor %}

			<b>Forvalter:</b><br>
			{% for system in app.systemer.all %}
				{{ system.kontakt_forvalter }}<br>
			{% empty %}
				-<br>
			{% endfor %}

			<b>IKT-hovedkontakt:</b><br>
			{% for system in app.systemer.all %}
				{{ system.kontakt_ikthoved }}<br>
			{% empty %}
				-
			{% endfor %}
		</td>

		<td>{{app.cache_antall_publisert_til}}</td>

		<td>
			{{app.publikasjon_json.WorkingDirectory|default:"-"}}<br>
			{{app.publikasjon_json.CommandLineExecutable|default:"-"}}<br>
			{{app.publikasjon_json.CommandLineArguments|default:"-"}}
		</td>


		<td>{{app.type_produksjon|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_nhn|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_vApp|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_nettleser|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_remotedesktop|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_executable|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_bat|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_vbs|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_ps1|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_cmd|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.type_medlemmer|yesno:"游릭 Ja, 游댮 Nei"}}</td>

		<td>{{app.publikasjon_json.Description|default:"-"}}</td>

		<td>{{app.publikasjon_json.UserFilterEnabled|yesno:"Ja, Nei"}}</td>


	</tr>
	{% endfor %}
</tbody>
</table>


{% endblock hovedinnhold %}